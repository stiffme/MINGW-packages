From 34973640a413dbe4692b84ae26910483eb7db67f Mon Sep 17 00:00:00 2001
From: "U-ERICSSON\\esipeng" <esipeng@CN00075689.ericsson.se>
Date: Sat, 27 Aug 2016 04:51:54 +0800
Subject: [PATCH] modify make to apply windres patch

---
 mingw-w64-geany/src/geany-1.28/src/Makefile.am | 5 ++++-
 mingw-w64-geany/src/geany-1.28/src/Makefile.in | 2 +-
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/mingw-w64-geany/src/geany-1.28/src/Makefile.am b/mingw-w64-geany/src/geany-1.28/src/Makefile.am
index bf13d28..a177227 100644
--- a/mingw-w64-geany/src/geany-1.28/src/Makefile.am
+++ b/mingw-w64-geany/src/geany-1.28/src/Makefile.am
@@ -146,7 +146,10 @@ geany_LDADD += geany_private.res
 WINDRES = $(host_alias)-windres
 
 geany_private.res: $(top_srcdir)/geany_private.rc
-	$(WINDRES) -i $(top_srcdir)/geany_private.rc --input-format=rc -o $@ -O coff
+	@MINGW_TRUE@	cp $(VPATH)/../geany_private.rc ./
+	@MINGW_TRUE@	cp $(VPATH)/../geany.exe.manifest ./
+	@MINGW_TRUE@	cp $(VPATH)/../icons/geany.ico ../icons/
+	@MINGW_TRUE@	$(WINDRES) -i geany_private.rc --input-format=rc -o geany_private.res -O coff;
 
 libgeany_la_SOURCES += win32.c win32.h
 libgeany_la_LIBADD  += -lole32 -lwsock32 -lcomdlg32
diff --git a/mingw-w64-geany/src/geany-1.28/src/Makefile.in b/mingw-w64-geany/src/geany-1.28/src/Makefile.in
index af5c46d..8416825 100644
--- a/mingw-w64-geany/src/geany-1.28/src/Makefile.in
+++ b/mingw-w64-geany/src/geany-1.28/src/Makefile.in
@@ -579,7 +579,7 @@ libgeany_la_LIBADD = $(top_builddir)/scintilla/libscintilla.la \
 # tell automake we have a C++ file so it uses the C++ linker we need for Scintilla
 nodist_EXTRA_libgeany_la_SOURCES = dummy1.cxx
 CLEANFILES = $(am__append_10) signallist.i
-@MINGW_TRUE@WINDRES = $(host_alias)-windres
+@MINGW_TRUE@WINDRES = windres
 glade_file = $(top_srcdir)/data/geany.glade
 all: all-am
 
-- 
2.9.1

